{"text": "package com.example.pruebafirebase2;\n\nimport android.os.Bundle;\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport android.text.TextUtils;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.Toast;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport com.google.firebase.auth.FirebaseAuth;\nimport com.google.firebase.firestore.FirebaseFirestore;\n\nimport java.util.HashMap;\nimport java.util.Map;\n\npublic class AgregarLibro extends AppCompatActivity {\n    private EditText titleEditText, authorEditText, yearEditText;\n    private Button saveBookButton;\n    private FirebaseFirestore db;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_agregar_libro);\n\n        titleEditText = findViewById(R.id.titleET);\n        authorEditText = findViewById(R.id.autorET);\n        yearEditText = findViewById(R.id.a\u00f1oET);\n        saveBookButton = findViewById(R.id.guardarBtn);\n\n        db = FirebaseFirestore.getInstance();\n\n        saveBookButton.setOnClickListener(v -> saveBook());\n    }\n\n    private void saveBook() {\n        String title = titleEditText.getText().toString();\n        String author = authorEditText.getText().toString();\n        String year = yearEditText.getText().toString();\n\n        if (TextUtils.isEmpty(title) || TextUtils.isEmpty(author) || TextUtils.isEmpty(year)) {\n            Toast.makeText(this, \"Por favor complete todos los campos\", Toast.LENGTH_SHORT).show();\n            return;\n        }\n\n        String userId = FirebaseAuth.getInstance().getCurrentUser().getUid();\n\n        Map<String, Object> book = new HashMap<>();\n        book.put(\"title\", title);\n        book.put(\"author\", author);\n        book.put(\"year\", year);\n        book.put(\"userId\", userId);\n\n        db.collection(\"books\").add(book).addOnSuccessListener(documentReference -> {\n            Toast.makeText(this, \"Libro agregado exitosamente\", Toast.LENGTH_SHORT).show();\n            finish();\n        }).addOnFailureListener(e -> Toast.makeText(this, \"Error: \" + e.getMessage(), Toast.LENGTH_SHORT).show());\n    }\n}\n"}
{"text": "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\">\n\n    <application\n        android:allowBackup=\"true\"\n        android:dataExtractionRules=\"@xml/data_extraction_rules\"\n        android:fullBackupContent=\"@xml/backup_rules\"\n        android:icon=\"@mipmap/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:roundIcon=\"@mipmap/ic_launcher_round\"\n        android:supportsRtl=\"true\"\n        android:theme=\"@style/Theme.PruebaFirebase2\"\n        tools:targetApi=\"31\">\n        <activity\n            android:name=\".Lista\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".AgregarLibro\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".Login\"\n            android:exported=\"true\" />\n\n        <activity\n            android:name=\".MainActivity\"\n            android:exported=\"true\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.MAIN\" />\n\n                <category android:name=\"android.intent.category.LAUNCHER\" />\n            </intent-filter>\n        </activity>\n    </application>\n\n</manifest>"}
{"text": "package com.example.pruebafirebase2;\n\nimport android.os.Bundle;\nimport android.view.View;\nimport android.widget.Toast;\n\nimport androidx.appcompat.app.AppCompatActivity;\nimport androidx.recyclerview.widget.LinearLayoutManager;\nimport androidx.recyclerview.widget.RecyclerView;\n\nimport com.google.firebase.auth.FirebaseAuth;\nimport com.google.firebase.firestore.FirebaseFirestore;\nimport com.google.firebase.firestore.QueryDocumentSnapshot;\n\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport android.widget.ArrayAdapter;\nimport android.widget.ListView;\n\n\npublic class Lista extends AppCompatActivity {\n\n    private ListView listView;\n    private ArrayAdapter<String> adapter;\n    private List<String> bookTitles;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_lista);\n\n        listView = findViewById(R.id.listaLV);\n        bookTitles = new ArrayList<>();\n\n        // Configuramos el adaptador simple para el ListView\n        adapter = new ArrayAdapter<>(this, android.R.layout.simple_list_item_1, bookTitles);\n        listView.setAdapter(adapter);\n\n        loadBooks();\n    }\n\n    private void loadBooks() {\n        String userId = FirebaseAuth.getInstance().getCurrentUser().getUid();\n        FirebaseFirestore.getInstance()\n                .collection(\"books\")\n                .whereEqualTo(\"userId\", userId)\n                .get()\n                .addOnCompleteListener(task -> {\n                    if (task.isSuccessful()) {\n                        bookTitles.clear();\n                        for (QueryDocumentSnapshot document : task.getResult()) {\n                            String title = document.getString(\"title\");\n                            String author = document.getString(\"author\");\n                            String year = document.getString(\"year\");\n\n                            // Agregamos una l\u00ednea de texto para cada libro\n                            bookTitles.add(title + \" - \" + author + \" (\" + year + \")\");\n                        }\n                        adapter.notifyDataSetChanged();\n                    } else {\n                        Toast.makeText(this, \"Error al cargar los libros\", Toast.LENGTH_SHORT).show();\n                    }\n                });\n    }\n\n    public void salir(View view){\n        finish();\n    }\n}\n\n\n"}
{"text": "package com.example.pruebafirebase2;\n\n\n\nimport android.content.Intent;\nimport android.os.Bundle;\nimport android.text.TextUtils;\nimport android.widget.Button;\nimport android.widget.EditText;\nimport android.widget.Toast;\n\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport com.google.firebase.auth.FirebaseAuth;\n\n\npublic class Login extends AppCompatActivity {\n    private EditText emailEditText, passwordEditText;\n    private Button loginButton, registerButton;\n    private FirebaseAuth mAuth;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_login);\n\n        emailEditText = findViewById(R.id.correoET);\n        passwordEditText = findViewById(R.id.contraET);\n        loginButton = findViewById(R.id.inicioBtn);\n        registerButton = findViewById(R.id.registrarBtn);\n\n        mAuth = FirebaseAuth.getInstance();\n\n        loginButton.setOnClickListener(v -> loginUser());\n        registerButton.setOnClickListener(v -> registerUser());\n    }\n\n    private void loginUser() {\n        String email = emailEditText.getText().toString();\n        String password = passwordEditText.getText().toString();\n\n        if (TextUtils.isEmpty(email) || TextUtils.isEmpty(password)) {\n            Toast.makeText(this, \"Por favor ingrese email y contrase\u00f1a\", Toast.LENGTH_SHORT).show();\n            return;\n        }\n\n        mAuth.signInWithEmailAndPassword(email, password).addOnCompleteListener(task -> {\n            if (task.isSuccessful()) {\n                Toast.makeText(this, \"Inicio de sesi\u00f3n exitoso\", Toast.LENGTH_SHORT).show();\n                startActivity(new Intent(this, MainActivity.class));\n                finish();\n            } else {\n                Toast.makeText(this, \"Error: \" + task.getException().getMessage(), Toast.LENGTH_SHORT).show();\n            }\n        });\n    }\n\n    private void registerUser() {\n        String email = emailEditText.getText().toString();\n        String password = passwordEditText.getText().toString();\n\n        if (TextUtils.isEmpty(email) || TextUtils.isEmpty(password)) {\n            Toast.makeText(this, \"Por favor ingrese email y contrase\u00f1a\", Toast.LENGTH_SHORT).show();\n            return;\n        }\n\n        mAuth.createUserWithEmailAndPassword(email, password).addOnCompleteListener(task -> {\n            if (task.isSuccessful()) {\n                Toast.makeText(this, \"Registro exitoso\", Toast.LENGTH_SHORT).show();\n                loginUser(); // Autologin after registration\n            } else {\n                Toast.makeText(this, \"Error: \" + task.getException().getMessage(), Toast.LENGTH_SHORT).show();\n            }\n        });\n    }\n}\n"}
{"text": "package com.example.pruebafirebase2;\n\nimport android.content.Intent;\nimport android.os.Bundle;\nimport android.widget.Button;\n\nimport androidx.appcompat.app.AppCompatActivity;\n\nimport com.google.firebase.auth.FirebaseAuth;\n\npublic class MainActivity extends AppCompatActivity {\n    private Button addBookButton, viewBooksButton, logoutButton;\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        addBookButton = findViewById(R.id.agregarLibroBtn);\n        viewBooksButton = findViewById(R.id.listarBtn);\n        logoutButton = findViewById(R.id.logoutBtn);\n\n        addBookButton.setOnClickListener(v -> startActivity(new Intent(this, AgregarLibro.class)));\n        viewBooksButton.setOnClickListener(v -> startActivity(new Intent(this, Lista.class)));\n        logoutButton.setOnClickListener(v -> {\n            FirebaseAuth.getInstance().signOut();\n            startActivity(new Intent(this, Login.class));\n            finish();\n        });\n    }\n}\n"}
